<!DOCTYPE html>
<html lang="es">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>Catálogo de Juegos — Detalle</title>
    <meta name="description" content="Ficha del juego: portada, plataformas, géneros, calificación, reseñas e imágenes." />
    <link rel="stylesheet" href="CSS/global.css" />
    <link rel="stylesheet" href="CSS/style.css" />
    <link rel="stylesheet" href="CSS/busqueda.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <video class="hero-background-video" autoplay loop muted playsinline>
      <source id="hero-video-source" src="assets/imagenes/Fondo2.mp4" type="video/mp4">
      Tu navegador no soporta videos.
    </video>
    <div class="page page-detail">
      <!-- Header: replicado de index.html para mantener estilo y comportamiento -->
      <header class="top-bar" role="banner">
        <div class="rectangle" aria-hidden="true">
          <img class="rectangle" src="assets/imagenes/LogoXH.png" alt="Logo" />
        </div>
        <h1 class="title">Checkpoint</h1>

        <nav class="navigation" aria-label="Navegación principal">
          <a class="tab btn-glitch" href="index.html" data-text="Inicio">Inicio</a>
          <a class="tab btn-glitch active" href="catalogo.html" data-text="Catalogo">Catalogo</a>

          <div class="input__container">
            <input
              type="text"
              placeholder="Buscar Juego"
              id="buscador"
              class="input__search"
            />

            <button
              class="input__button__shadow ic-search"
              type="button"
              aria-label="Buscar"
            >
              <img
                class="shape"
                src="assets/imagenes/lupa.png"
                alt="Icono de búsqueda"
              />
            </button>

            <div class="shadow__input"></div>
          </div>

          <div id="auth-container"></div>
        </nav>
      </header>

      <main class="detail-page">
        <div class="container py-4">
          <!-- Estado de carga / errores -->
          <div id="status" class="text-center mb-4 text-muted">Cargando juego...</div>

          <!-- Hero del juego -->
          <section id="game-hero" class="mb-5 pad-wide" aria-live="polite" aria-busy="true">
            <div class="hero-head d-flex flex-wrap align-items-start gap-4">
              <div class="hero-left flex-grow-1">
                <h2 id="game-title" class="detail-title mb-2">Título del juego</h2>
                <div id="game-rating-box" class="rating-box mb-2" style="display:none;">
                  Calificación: <span id="game-rating-text">0.0</span>
                </div>
                <div class="hero-meta detail-badges mt-2">
                  <div class="hero-meta-item">
                    <strong>Fecha de lanzamiento:</strong>
                    <span class="badge bg-primary ms-2" id="game-release">—</span>
                  </div>
                  <div class="hero-meta-item">
                    <strong>Plataformas:</strong>
                    <span class="badge bg-secondary ms-2" id="game-platforms">—</span>
                  </div>
                  <div class="hero-meta-item">
                    <strong>Géneros:</strong>
                    <span class="badge bg-success ms-2" id="game-genres">—</span>
                  </div>
                </div>
                <div class="hero-stores-wrapper" id="hero-stores"></div>
              </div>
              <div class="hero-right ms-auto">
                <div class="detail-cover-wrapper">
                  <img id="game-cover" class="detail-cover-img" src="assets/imagenes/LogoXH.png" alt="Portada del juego" />
                </div>
              </div>
            </div>
          </section>

          <!-- Bloque 1: Descripción (izq) + Datos rápidos (der) -->
          <section id="detail-body" class="row g-4 align-items-start pad-wide">
            <!-- Descripción en tarjeta -->
            <div class="col-12 col-md-8" id="detail-main">
              <section class="mb-4">
                <div class="aside-card">
                  <h3 class="aside-title">Descripción</h3>
                  <p id="game-description" class="aside-content">Descripción completa del juego.</p>
                </div>
              </section>
            </div>

            <!-- Datos rápidos a la derecha -->
            <aside class="col-12 col-md-4 detail-aside">
              <div id="facts-card" class="aside-card mb-4">
                <h4 class="aside-title">Datos rápidos</h4>
                <div id="facts-content" class="aside-content text-sm"></div>
              </div>
              <!-- Opiniones de la comunidad -->
              <div id="ratings-card" class="aside-card mb-4" style="display:none;">
                <h4 class="aside-title">Opiniones de la comunidad</h4>
                <div id="ratings-breakdown" class="aside-content"></div>
              </div>
              <!-- Etiquetas del juego -->
              <div id="tags-card" class="aside-card mb-4" style="display:none;">
                <h4 class="aside-title">Etiquetas</h4>
                <div id="tags-content" class="aside-content"></div>
              </div>
            </aside>
          </section>

          <!-- Especificaciones del Sistema (solo para juegos de PC con requisitos) -->
          <section id="game-specs-section" class="detail-section mb-5" style="display:none;">
            <h3 class="detail-section-title">Especificaciones del Sistema (PC)</h3>
            <div class="container">
              <div class="row g-4 justify-content-center">
                <div class="col-12 col-md-6" id="specs-minimum-wrapper" style="display:none;">
                  <h4 class="detail-subsection-title">Mínimas</h4>
                  <div id="specs-minimum" class="detail-specs-box"></div>
                </div>
                <div class="col-12 col-md-6" id="specs-recommended-wrapper" style="display:none;">
                  <h4 class="detail-subsection-title">Recomendadas</h4>
                  <div id="specs-recommended" class="detail-specs-box"></div>
                </div>
              </div>
            </div>
          </section>

          <!-- Bloque 2: Galería + Juegos parecidos (a lo ancho) -->
          <section class="detail-section mb-5">
            <h3 class="detail-section-title">Galería</h3>
            <div class="products products--gallery">
              <div class="list" id="gallery-rail"></div>
            </div>
          </section>
          <section class="detail-section mb-5">
            <h3 class="detail-section-title">Juegos Similares</h3>
            <div class="products products--detail">
              <div class="list" id="suggestions-rail"></div>
            </div>
          </section>
        </div>
      </main>

      <footer class="container-5" role="contentinfo">
        <p class="title-13">© 2025 SA. de CV.</p>
        <div class="title-14">Politicas de Privacidad</div>
        <div class="title-15">Terminos de Servicio</div>
        <div class="title-16">Contactanos</div>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Auth (igual que en index): Firebase + UI básica en el header -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script>
      (function(){
        try {
          const firebaseConfig = {
            apiKey: "AIzaSyAHXOnzpazOGRkSwuD9JGmU-jGw2TKcgXA",
            authDomain: "retoapi-ff801.firebaseapp.com",
            projectId: "retoapi-ff801",
            storageBucket: "retoapi-ff801.firebasestorage.app",
            messagingSenderId: "650992142854",
            appId: "1:650992142854:web:ddf60d1f3d0ea540c79187",
            measurementId: "G-0ZJQRJTF86"
          };
          if (window.firebase && !firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
          }
          if (!window.firebase) return;
          const auth = firebase.auth();
          const provider = new firebase.auth.GoogleAuthProvider();
          const authContainer = document.getElementById('auth-container');
          if (!authContainer) return;

          const login = () => auth.signInWithPopup(provider);
          const logout = () => auth.signOut();

          const showLoginUI = () => {
            authContainer.innerHTML = `<button id="btn-google-login" class="header-login-btn btn-glitch" data-text="Iniciar sesión con Google">Iniciar sesión con Google</button>`;
            const btn = document.getElementById('btn-google-login');
            if (btn) btn.addEventListener('click', login);
          };

          const showLogoutUI = (user) => {
            const profilePic = (user && user.photoURL) || '';
            const name = (user && user.displayName) || 'Usuario';
            authContainer.innerHTML = `
              <div class="user-info-header">
                <div class="header-avatar">
                  <img src="${profilePic}" alt="Avatar de ${name}" onerror="this.src='assets/imagenes/LogoXH.png'; this.alt='Avatar';" />
                </div>
                <div class="header-username">${name}</div>
                <button id="btn-logout" class="header-logout-btn">Cerrar Sesión</button>
              </div>`;
            const out = document.getElementById('btn-logout');
            if (out) out.addEventListener('click', logout);
          };

          auth.onAuthStateChanged((user) => {
            if (user) showLogoutUI(user); else showLoginUI();
          });
        } catch(e) {
          // si falla auth, no bloqueamos la página de detalle
          console.warn('Auth no inicializado en busqueda:', e);
        }
      })();
    </script>
    <script src="JS/busqueda.js" defer></script>
  </body>
</html>
